# ------------------------
# One-compartment model with first-order absorption rate and 
# linear elimination (metabolism or other route of elimination) 
#
# version 1
#
# Units: 
# - time in hours
# - volumes in liters
# - masses of substances in micromoles
# - concentrations of substances in microM
# ------------------------

States  = {Q_rest,
           Q_elim
}; 

Outputs = {C_rest,          # Concentration in central compartment (uM)
           Q_total};        # Total quantity for mass balance (mg)

Inputs  = {Oral_input};     # Drug input in micromoles


# ------------------------
# Parameters
# ------------------------

MW; # molecular weight (g/mole)

# Oral input modeling

IngDose    = 0.0; # ingested input (mg/kg)
Period     = 0.0; # period of the exposure/no exposure cycle (h)
Tlag       = 0.0; # Absorption lagtime (h)
Ka         = 0.0; # Intestinal absortion rate (/h)
Oral_input = PerExp (IngDose, Period, Tlag, Ka);

# Volumes (L)
V_dist  = 1; 

# Transfer rate constants between compartments (/h)
k_gutabs;
k_elim;

Dynamics {
  dt (Q_rest)  = k_gutabs * Oral_input - k_elim * Q_rest;
  dt (Q_elim)  = k_elim * Q_rest; 
}

CalcOutputs {
  C_rest  = Q_rest  / V_dist / MW * 1000;
  Q_total = Q_rest + Q_elim;
}

End.
